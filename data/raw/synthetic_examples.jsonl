{"id": "tuxedo_zgizn_0000", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0001", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0002", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0003", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "tuxedo_bfxtc_0004", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0005", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0006", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "gym_ycebc_0007", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0008", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0009", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_nfaol_0010", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "wedding_venue_hbfal_0011", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "tuxedo_lloce_0012", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0013", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "coworking_hbmcl_0014", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0015", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_qdrtr_0016", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0017", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0018", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0019", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0020", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0021", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0022", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0023", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0024", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0025", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0026", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "tuxedo_weamd_0027", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "tuxedo_tclda_0028", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "tuxedo_leesw_0029", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0030", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0031", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_ngvdy_0032", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "coworking_jskcq_0033", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0034", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "classroom_xvhvs_0035", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0036", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0037", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0038", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0039", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0040", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "coworking_dkazs_0041", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "villas_wnmlr_0042", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "villas_pdfys_0043", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "gym_hdiez_0044", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0045", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "villas_twzuq_0046", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0047", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0048", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0049", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0050", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0051", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0052", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0053", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "salon_pynrx_0054", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0055", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0056", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0057", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "villas_ywitn_0058", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0059", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "tuxedo_fjojw_0060", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0061", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0062", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0063", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0064", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0065", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0066", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0067", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "classroom_bkuns_0068", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "wedding_venue_qgvlt_0069", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "salon_ugxuo_0070", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0071", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "salon_ionep_0072", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "salon_yhlox_0073", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "wedding_venue_eetif_0074", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0075", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_drzhz_0076", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0077", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_dipnz_0078", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "wedding_venue_iuaua_0079", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0080", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0081", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0082", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_rsmmw_0083", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0084", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0085", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0086", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "classroom_xleww_0087", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0088", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0089", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0090", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0091", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "wedding_venue_lkoxq_0092", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0093", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0094", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0095", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "salon_kgwlj_0096", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "villas_lukui_0097", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0098", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "classroom_kiqgp_0099", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0100", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0101", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "gym_mqskh_0102", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "coworking_zsxfd_0103", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "gym_gdgyf_0104", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0105", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0106", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0107", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "gym_mtnmg_0108", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0109", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0110", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0111", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0112", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0113", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0114", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0115", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0116", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "coworking_ncajx_0117", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0118", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0119", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "villas_ikkrp_0120", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "classroom_pqqhr_0121", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0122", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0123", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "gym_cpocb_0124", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0125", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0126", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "gym_dwzic_0127", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "tuxedo_suxho_0128", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "villas_ubtet_0129", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0130", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "wedding_venue_llnvd_0131", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0132", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0133", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_dhnpi_0134", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0135", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0136", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "salon_hnumb_0137", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "villas_dfmuw_0138", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "wedding_venue_mzlwc_0139", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0140", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "coworking_syaxf_0141", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0142", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0143", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0144", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0145", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0146", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_hymgm_0147", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "gym_qoydl_0148", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0149", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_rwzdb_0150", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0151", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0152", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0153", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0154", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "salon_xencf_0155", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "villas_gljdl_0156", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "wedding_venue_tbslw_0157", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0158", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "salon_fckcq_0159", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "classroom_fkpwj_0160", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "salon_arvpe_0161", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "classroom_hmnzm_0162", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0163", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_rehbu_0164", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0165", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0166", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0167", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "classroom_pbflx_0168", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "gym_usfbr_0169", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0170", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0171", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "salon_qdztn_0172", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "gym_klewl_0173", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "wedding_venue_jfuye_0174", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "villas_ecdcd_0175", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0176", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "coworking_wpzck_0177", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0178", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "tuxedo_tdfeb_0179", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0180", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0181", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0182", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0183", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "salon_zcdzi_0184", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0185", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0186", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0187", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0188", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0189", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0190", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0191", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0192", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "salon_xqpzd_0193", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "villas_hdowr_0194", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0195", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "gym_qjygk_0196", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0197", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0198", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0199", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0200", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "gym_tqepb_0201", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0202", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0203", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0204", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0205", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "gym_wxcox_0206", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0207", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "classroom_ddeyf_0208", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0209", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "salon_rskoh_0210", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "classroom_qcecw_0211", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0212", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_ghoyv_0213", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0214", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0215", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0216", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0217", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0218", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "salon_xtwit_0219", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0220", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "coworking_dhyfv_0221", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "tuxedo_qegzn_0222", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "classroom_tjwmv_0223", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "wedding_venue_frtdu_0224", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0225", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0226", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0227", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0228", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_ebfao_0229", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0230", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0231", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "classroom_tsgdv_0232", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0233", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0234", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0235", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0236", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0237", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "villas_fkven_0238", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0239", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "gym_cjvjd_0240", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0241", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0242", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0243", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_wsyhy_0244", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "salon_oantb_0245", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "gym_ngicg_0246", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0247", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0248", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "coworking_mcfrj_0249", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0250", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "classroom_gwzzj_0251", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "gym_wsjhc_0252", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0253", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "salon_nzkdi_0254", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0255", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0256", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_rczdf_0257", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0258", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_ilndm_0259", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "gym_eflxg_0260", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0261", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0262", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "villas_hwssa_0263", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "gym_appdf_0264", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "gym_hdfbl_0265", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "villas_rwuij_0266", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0267", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0268", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0269", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "classroom_dxarj_0270", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "villas_tsnkk_0271", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "salon_avlpg_0272", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0273", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0274", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "salon_zrfhl_0275", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "villas_xyxou_0276", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0277", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "wedding_venue_vvpyt_0278", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0279", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0280", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_awult_0281", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0282", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0283", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "gym_lmitg_0284", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "gym_mzzfw_0285", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0286", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_heyxy_0287", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "coworking_eoiyk_0288", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "coworking_bxdnw_0289", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0290", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0291", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "wedding_venue_xoxkd_0292", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0293", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0294", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "tuxedo_lgoji_0295", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0296", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_ncokq_0297", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "salon_syyjj_0298", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0299", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0300", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0301", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0302", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "coworking_sgqju_0303", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0304", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0305", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "villas_alwmu_0306", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0307", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_ujrna_0308", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0309", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0310", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0311", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0312", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0313", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "coworking_azusb_0314", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "gym_lezzt_0315", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "coworking_kgdly_0316", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "salon_rivbw_0317", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0318", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0319", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_soahv_0320", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "classroom_ggyzp_0321", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "villas_vtlgc_0322", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "classroom_mglam_0323", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0324", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0325", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "coworking_ntosy_0326", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0327", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "coworking_gfnel_0328", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "gym_ldafb_0329", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "gym_duhoz_0330", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "coworking_dhhpk_0331", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0332", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_gqpgk_0333", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0334", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_wxciv_0335", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "salon_rljct_0336", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "tuxedo_okekk_0337", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0338", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "salon_cwtyx_0339", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0340", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0341", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "classroom_owrpn_0342", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0343", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_eqxsw_0344", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0345", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0346", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0347", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0348", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "coworking_wiuge_0349", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0350", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0351", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0352", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "coworking_akrvl_0353", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0354", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "gym_kednq_0355", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "gym_ylheh_0356", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "tuxedo_ztbmg_0357", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0358", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0359", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_qnmhs_0360", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0361", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "coworking_fwpbs_0362", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "gym_sfisp_0363", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0364", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "salon_ghymv_0365", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "classroom_fcaml_0366", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0367", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0368", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0369", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0370", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0371", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0372", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "gym_tyzab_0373", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0374", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0375", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0376", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0377", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "salon_xozhd_0378", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0379", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0380", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0381", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0382", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "classroom_pvjjz_0383", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0384", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0385", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0386", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0387", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "villas_ztlrw_0388", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "villas_rmiti_0389", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0390", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0391", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "classroom_yndnp_0392", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0393", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0394", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "classroom_xosmq_0395", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "gym_tafms_0396", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0397", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "coworking_sltfq_0398", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0399", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "salon_dmxgu_0400", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "villas_neqlo_0401", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0402", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "villas_yqvbs_0403", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "tuxedo_omsvo_0404", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "coworking_gtieh_0405", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0406", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0407", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0408", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "gym_yvesk_0409", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "tuxedo_sauoa_0410", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0411", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0412", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "gym_tcgwc_0413", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "tuxedo_qwecr_0414", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0415", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0416", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0417", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "classroom_mfvih_0418", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0419", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0420", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0421", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_fobtz_0422", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "tuxedo_ybrll_0423", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0424", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_lkxqd_0425", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "villas_whoan_0426", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0427", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0428", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0429", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0430", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0431", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "classroom_cfjbz_0432", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0433", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "classroom_doygi_0434", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "wedding_venue_ambln_0435", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "gym_aorbg_0436", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "tuxedo_tzzsp_0437", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "tuxedo_kiglw_0438", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0439", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0440", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0441", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0442", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0443", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0444", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0445", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0446", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "salon_tyaiv_0447", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "villas_zrnrz_0448", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0449", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_tblyu_0450", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0451", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0452", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0453", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0454", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "classroom_sddrv_0455", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0456", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "classroom_iycyx_0457", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0458", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0459", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_veqjd_0460", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "salon_oldja_0461", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0462", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "gym_ymnsf_0463", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0464", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "coworking_nympz_0465", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0466", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "coworking_nubbx_0467", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "wedding_venue_xfecv_0468", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0469", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_lutgj_0470", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "tuxedo_uxlix_0471", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0472", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0473", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0474", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "gym_oredb_0475", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "villas_dfsuy_0476", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0477", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "classroom_lbvzv_0478", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0479", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "coworking_uiwys_0480", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0481", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "classroom_xnvjh_0482", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0483", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0484", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "salon_khhms_0485", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "villas_vdlmn_0486", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "gym_pjuwn_0487", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0488", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "classroom_buahf_0489", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0490", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0491", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0492", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "coworking_htmyg_0493", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "classroom_xwmqv_0494", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0495", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "tuxedo_giiur_0496", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "villas_xpatr_0497", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0498", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0499", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "tuxedo_qbamn_0500", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0501", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "villas_ksoss_0502", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "tuxedo_anujj_0503", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "coworking_bcjii_0504", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0505", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0506", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0507", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0508", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "coworking_sgnmj_0509", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0510", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0511", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0512", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0513", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0514", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0515", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0516", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "villas_enywl_0517", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0518", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "classroom_vpgqc_0519", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "tuxedo_prjbi_0520", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0521", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0522", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "gym_iocgt_0523", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "coworking_nesds_0524", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0525", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0526", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0527", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0528", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "classroom_epsur_0529", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "classroom_rubah_0530", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0531", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0532", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "coworking_wbjac_0533", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0534", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0535", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0536", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0537", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0538", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0539", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0540", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "villas_nhziy_0541", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0542", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0543", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0544", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_mdzhx_0545", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "gym_uqelj_0546", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0547", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0548", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_gfbwu_0549", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0550", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0551", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0552", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0553", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0554", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "salon_xgpft_0555", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0556", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "salon_gtmmj_0557", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "villas_xbens_0558", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0559", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0560", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_afrpn_0561", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0562", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0563", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0564", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0565", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0566", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "gym_xccnj_0567", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "coworking_fcmbd_0568", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "salon_nymyp_0569", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0570", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "wedding_venue_lvskx_0571", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "wedding_venue_abtkj_0572", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "gym_vudij_0573", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "gym_wyjpo_0574", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0575", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0576", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0577", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "wedding_venue_vvtgx_0578", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "classroom_hacul_0579", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0580", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "classroom_qrpjl_0581", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "villas_qeckz_0582", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0583", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0584", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "salon_ipydr_0585", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "villas_fkdfb_0586", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "gym_vuesq_0587", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0588", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0589", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0590", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0591", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0592", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "salon_gvaoo_0593", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0594", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0595", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0596", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0597", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0598", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0599", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0600", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0601", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0602", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "villas_ezizd_0603", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0604", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_fyisg_0605", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "classroom_jwfmh_0606", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "tuxedo_wxmmb_0607", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0608", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0609", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0610", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0611", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0612", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0613", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "gym_lemim_0614", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0615", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "coworking_orzgk_0616", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "tuxedo_yreop_0617", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "gym_vllsm_0618", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "villas_zvvyt_0619", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0620", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0621", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0622", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "coworking_rarjh_0623", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0624", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0625", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0626", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0627", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0628", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0629", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0630", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0631", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0632", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0633", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "gym_zoqqh_0634", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "tuxedo_eayji_0635", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "coworking_cmkau_0636", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0637", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "wedding_venue_vmzsc_0638", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0639", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "coworking_qmosc_0640", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0641", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0642", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0643", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0644", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "villas_mlymo_0645", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0646", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0647", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0648", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0649", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_xuylj_0650", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0651", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0652", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0653", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0654", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "salon_idcih_0655", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0656", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "coworking_faggk_0657", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "salon_ewejr_0658", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0659", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "salon_rmnyo_0660", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "coworking_oiqqm_0661", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0662", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_zzfuf_0663", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "tuxedo_fetjs_0664", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0665", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_ycrqd_0666", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0667", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "classroom_bsmnb_0668", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0669", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0670", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_kadct_0671", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "villas_qfnxe_0672", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "tuxedo_tiqsa_0673", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "coworking_zkfvv_0674", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0675", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0676", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0677", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0678", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "coworking_zcvyf_0679", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0680", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "coworking_brptb_0681", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0682", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_yblcq_0683", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "classroom_vwklp_0684", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0685", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0686", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0687", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "tuxedo_ceumn_0688", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0689", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "salon_zraia_0690", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0691", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0692", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0693", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "salon_yibeb_0694", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0695", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0696", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0697", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0698", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0699", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0700", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0701", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0702", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0703", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0704", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0705", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0706", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0707", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0708", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0709", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_crzoj_0710", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0711", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0712", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_hjozs_0713", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "villas_jolgu_0714", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "salon_arouf_0715", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0716", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0717", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "coworking_dqlzw_0718", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0719", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0720", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0721", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0722", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_tofrv_0723", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "villas_boecb_0724", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0725", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0726", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0727", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0728", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_haspw_0729", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "salon_nrgsc_0730", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0731", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_sexzb_0732", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0733", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "gym_iysph_0734", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0735", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0736", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_lyzdt_0737", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0738", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0739", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "classroom_egcby_0740", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "villas_dheme_0741", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0742", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0743", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0744", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "villas_haomz_0745", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "salon_fqrax_0746", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0747", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "salon_wjkjk_0748", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0749", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "classroom_jjnbs_0750", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0751", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0752", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0753", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0754", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0755", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0756", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "tuxedo_zcjki_0757", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "wedding_venue_idogn_0758", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0759", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0760", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0761", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0762", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0763", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0764", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0765", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "gym_uhttv_0766", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0767", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0768", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0769", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0770", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0771", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0772", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0773", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "salon_pblze_0774", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0775", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "coworking_gcloi_0776", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "classroom_qpiwg_0777", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "tuxedo_utzmx_0778", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0779", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_bpnjc_0780", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0781", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0782", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0783", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_zakii_0784", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0785", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0786", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0787", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0788", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0789", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0790", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0791", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "wedding_venue_mxozu_0792", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0793", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0794", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0795", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_hnfdk_0796", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "wedding_venue_uzeao_0797", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0798", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_qchjf_0799", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0800", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0801", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_gqgim_0802", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "classroom_ixbca_0803", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "coworking_nrdxj_0804", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "villas_stntr_0805", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "tuxedo_xvfvt_0806", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0807", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "salon_mbvgp_0808", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "tuxedo_rvpfw_0809", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "tuxedo_bzzut_0810", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0811", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0812", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0813", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0814", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0815", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0816", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "villas_ezhcw_0817", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0818", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "coworking_omaso_0819", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "wedding_venue_ykxry_0820", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "wedding_venue_vppgs_0821", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0822", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_rrzfz_0823", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "salon_sptwq_0824", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0825", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0826", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_ganzz_0827", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0828", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0829", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "classroom_xfwdx_0830", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "villas_pcyej_0831", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0832", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "wedding_venue_vubjd_0833", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0834", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0835", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "salon_uwuqt_0836", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "classroom_hrsgc_0837", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0838", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "classroom_kekbk_0839", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0840", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_txtwb_0841", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "villas_dvhmh_0842", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0843", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "coworking_pnycc_0844", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0845", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "tuxedo_wsrch_0846", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0847", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_fmjur_0848", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0849", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0850", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_eywpo_0851", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0852", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0853", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0854", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0855", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0856", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0857", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "salon_onvax_0858", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "classroom_hqvta_0859", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0860", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0861", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_oaxbg_0862", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "gym_jwtbk_0863", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0864", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0865", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0866", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "classroom_dfwci_0867", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0868", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0869", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "coworking_cfugn_0870", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "gym_fuvoq_0871", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "tuxedo_mtyhw_0872", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0873", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0874", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0875", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0876", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0877", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_znowo_0878", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0879", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0880", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0881", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "villas_fkczp_0882", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0883", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0884", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0885", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0886", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0887", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0888", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0889", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_lwoyf_0890", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0891", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0892", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0893", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0894", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0895", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0896", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "gym_wlxbg_0897", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "coworking_qaekx_0898", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "coworking_ignjf_0899", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0900", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0901", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "villas_xbadw_0902", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0903", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "villas_szwxv_0904", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0905", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "classroom_vqfbj_0906", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0907", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0908", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0909", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0910", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_aehdt_0911", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0912", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0913", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "classroom_wjmtd_0914", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0915", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0916", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0917", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0918", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0919", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "classroom_rbkpg_0920", "schema": "CREATE TABLE classrooms (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, capacity integer); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), classroom_id uuid REFERENCES classrooms(id), event_name text, start_time timestamptz, end_time timestamptz);", "task": "Book a classroom for a workshop on 2024-10-15 from 2 PM to 4 PM.", "output": {"actions": ["insert"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_classroom_time ON bookings (classroom_id, start_time, end_time);"}], "queries": [{"description": "Insert booking", "sql": "INSERT INTO bookings (classroom_id, event_name, start_time, end_time) VALUES ($1, 'Workshop', '2024-10-15 14:00:00'::timestamptz, '2024-10-15 16:00:00'::timestamptz);"}], "error_explanations": [], "explanations": ["Basic insert for booking."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0921", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "coworking_bcyyz_0922", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0923", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "salon_szgla_0924", "schema": "CREATE TABLE services (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, price numeric(7,2)); CREATE TABLE appointments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, service_id uuid REFERENCES services(id), appointment_time timestamptz); CREATE TABLE slots (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), start_time timestamptz, available boolean DEFAULT true);", "task": "Book a haircut appointment tomorrow if slot is free.", "output": {"actions": ["insert", "select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_appointments_time ON appointments (appointment_time);"}], "queries": [{"description": "Conditional insert", "sql": "INSERT INTO appointments (customer_id, service_id, appointment_time) SELECT $1, $2, $3 WHERE NOT EXISTS (SELECT 1 FROM appointments a WHERE a.appointment_time = $3);"}], "error_explanations": [], "explanations": ["Inserted only if no conflicting appointment."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0925", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "wedding_venue_rbayz_0926", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0927", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0928", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0929", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0930", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "gym_nqjki_0931", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "wedding_venue_tnnse_0932", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "wedding_venue_fffjt_0933", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0934", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "gym_vzrhl_0935", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0936", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0937", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "villas_zodus_0938", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0939", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0940", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0941", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0942", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0943", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "villas_ukukq_0944", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0945", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0946", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0947", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0948", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "wedding_venue_lxyjj_0949", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0950", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0951", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "gym_mpafq_0952", "schema": "CREATE TABLE classes (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), instructor_id uuid, name text, schedule timestamptz, max_capacity integer); CREATE TABLE enrollments (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), class_id uuid REFERENCES classes(id), student_id uuid);", "task": "List gym classes with current enrollment count next week.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_enrollments_class ON enrollments (class_id);"}], "queries": [{"description": "Classes with enrollment counts", "sql": "SELECT c.name, c.schedule, count(e.id) as enrolled FROM classes c LEFT JOIN enrollments e ON c.id = e.class_id WHERE c.schedule >= current_timestamp + interval '1 day' AND c.schedule < current_timestamp + interval '1 week' GROUP BY c.id, c.name, c.schedule HAVING count(e.id) < c.max_capacity;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and HAVING for filtered counts."], "safe_to_execute": true}}
{"id": "coworking_ljtdr_0953", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "wedding_venue_cibuc_0954", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0955", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0956", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0957", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "tuxedo_zlpdo_0958", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0959", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0960", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "villas_zefrg_0961", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0962", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0963", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_ufgxl_0964", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0965", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0966", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "wedding_venue_nngnx_0967", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "tuxedo_kuccq_0968", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0969", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "villas_lbynn_0970", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "tuxedo_fhlcd_0971", "schema": "CREATE TABLE tuxedos (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), size text, color text, rental_price numeric(7,2)); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), tuxedo_id uuid REFERENCES tuxedos(id), renter_id uuid, start_date date, end_date date);", "task": "Check if a specific tuxedo is available for rental from 2024-11-01 to 2024-11-05.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_tuxedo_dates ON rentals (tuxedo_id, start_date, end_date);"}], "queries": [{"description": "Tuxedo availability", "sql": "SELECT CASE WHEN EXISTS (SELECT 1 FROM rentals r WHERE r.tuxedo_id = $1 AND (r.start_date, r.end_date) OVERLAPS ('2024-11-01'::date, '2024-11-05'::date)) THEN false ELSE true END AS available;"}], "error_explanations": [], "explanations": ["Used OVERLAPS for date range checking."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0972", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0973", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_xuvaa_0974", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "wedding_venue_grmuv_0975", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0976", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "villas_bvpdl_0977", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0978", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0979", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0980", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0981", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0982", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_product_search_0983", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find products by name and category matching a query.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_products_name_category ON products (name, category);"}], "queries": [{"description": "Search products", "sql": "SELECT p.id, p.name, p.price FROM products p WHERE p.name ILIKE '%keyword%' AND p.category = 'electronics' ORDER BY p.price ASC LIMIT 50;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "wedding_venue_txylh_0984", "schema": "CREATE TABLE venues (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, city text, capacity integer, price_per_hour numeric(10,2)); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), venue_id uuid REFERENCES venues(id), customer_id uuid, booked_date date, start_time time, end_time time);", "task": "Find wedding venues in Jakarta available on 2024-12-15 for 100-200 people.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_venues_city_capacity ON venues (city, capacity);"}, {"sql": "CREATE INDEX idx_bookings_venue_date ON bookings (venue_id, booked_date);"}], "queries": [{"description": "Available venues", "sql": "SELECT v.id, v.name FROM venues v WHERE v.city = 'Jakarta' AND v.capacity BETWEEN 100 AND 200 AND NOT EXISTS (SELECT 1 FROM bookings b WHERE b.venue_id = v.id AND b.booked_date = '2024-12-15');"}], "error_explanations": [], "explanations": ["Checked availability using NOT EXISTS."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0985", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "coworking_xpzrd_0986", "schema": "CREATE TABLE desks (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), zone text, hourly_rate numeric(5,2)); CREATE TABLE reservations (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), desk_id uuid REFERENCES desks(id), user_id uuid, reserved_date date, start_time time, end_time time);", "task": "Find free coworking desks in Zone A tomorrow.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_desks_zone ON desks (zone);"}, {"sql": "CREATE INDEX idx_reservations_desk_date ON reservations (desk_id, reserved_date);"}], "queries": [{"description": "Free desks tomorrow", "sql": "SELECT d.id, d.hourly_rate FROM desks d WHERE d.zone = 'A' AND NOT EXISTS (SELECT 1 FROM reservations r WHERE r.desk_id = d.id AND r.reserved_date = current_date + interval '1 day');"}], "error_explanations": [], "explanations": ["Assumed full day booking for simplicity."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0987", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0988", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0989", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "general_sql_partial_indexes_0990", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Add a partial index to speed up queries on active products.", "output": {"actions": ["add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX CONCURRENTLY idx_active_products_name ON products (name) WHERE active = true;"}], "queries": [], "error_explanations": [], "explanations": ["Added partial index for active products to improve query performance."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0991", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0992", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "villas_mqiqf_0993", "schema": "CREATE TABLE villas (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, location text, max_guests integer); CREATE TABLE rentals (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), villa_id uuid REFERENCES villas(id), start_date date, end_date date);", "task": "Find villas available for booking from 2024-12-20 to 2024-12-25.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_rentals_villa_dates ON rentals (villa_id, start_date, end_date);"}], "queries": [{"description": "Available villas", "sql": "SELECT v.id, v.name FROM villas v WHERE v.max_guests >= 4 AND NOT EXISTS (SELECT 1 FROM rentals r WHERE r.villa_id = v.id AND (r.start_date, r.end_date) OVERLAPS ('2024-12-20'::date, '2024-12-25'::date));"}], "error_explanations": [], "explanations": ["Checked for overlaps in rental dates."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0994", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "general_sql_joins_and_aggregates_0995", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Calculate the total order value for each customer.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Customer order totals", "sql": "SELECT c.name, sum(o.total_amount) as total FROM customers c LEFT JOIN orders o ON c.id = o.customer_id WHERE o.status = 'completed' GROUP BY c.id, c.name ORDER BY total DESC;"}], "error_explanations": [], "explanations": ["Used LEFT JOIN and aggregate sum for totals."], "safe_to_execute": true}}
{"id": "general_sql_window_functions_0996", "schema": "CREATE TABLE customers (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, active boolean DEFAULT true); CREATE TABLE bookings (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid REFERENCES customers(id), booking_date date, amount numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, total_amount numeric(8,2), status text); CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, active boolean DEFAULT true);", "task": "Find the last booking per customer using window functions.", "output": {"actions": ["select", "add_indexes"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_bookings_customer ON bookings (customer_id);"}], "queries": [{"description": "Last booking per customer", "sql": "SELECT id, customer_id, booking_date FROM (SELECT id, customer_id, booking_date, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY booking_date DESC) as rn FROM bookings) sub WHERE rn = 1;"}], "error_explanations": [], "explanations": ["Used ROW_NUMBER window function to rank bookings per customer."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0997", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_abandoned_carts_0998", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "Find customers with abandoned carts (not updated in the last 7 days).", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_carts_updated ON carts (updated_at);"}], "queries": [{"description": "Abandoned carts with details", "sql": "SELECT c.customer_id, array_agg(ci.product_id) as product_ids FROM carts c JOIN cart_items ci ON c.id = ci.cart_id WHERE c.updated_at < current_timestamp - interval '7 days' GROUP BY c.customer_id;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
{"id": "ecommerce_bestselling_products_0999", "schema": "CREATE TABLE products (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), name text, category text, price numeric(8,2)); CREATE TABLE orders (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, order_date date); CREATE TABLE order_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), order_id uuid REFERENCES orders(id), product_id uuid REFERENCES products(id), quantity integer); CREATE TABLE carts (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), customer_id uuid, updated_at timestamptz); CREATE TABLE cart_items (id uuid PRIMARY KEY DEFAULT gen_random_uuid(), cart_id uuid REFERENCES carts(id), product_id uuid, quantity integer);", "task": "List top 10 best-selling products over the last 90 days.", "output": {"actions": ["select"], "migrations": [], "rls_policies": [], "indexes": [{"sql": "CREATE INDEX idx_order_items_product ON order_items (product_id);"}, {"sql": "CREATE INDEX idx_orders_date ON orders (order_date);"}], "queries": [{"description": "Top products by sales", "sql": "SELECT p.name, sum(oi.quantity) as total_sold FROM products p JOIN order_items oi ON p.id = oi.product_id JOIN orders o ON oi.order_id = o.id WHERE o.order_date >= current_date - interval '90 days' GROUP BY p.id, p.name ORDER BY total_sold DESC LIMIT 10;"}], "error_explanations": [], "explanations": ["Used text search with ILIKE and filtering by category."], "safe_to_execute": true}}
